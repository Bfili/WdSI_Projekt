# WdSI_Projekt
### Opis programu
Program zawarty w tym repozytorium zajmuje się klasyfikacją binarną znaków, gdzie docelowo poszukiwanymi znakami są znaki przejść dla pieszych (pozostałe znaki są kategoryzowane jako "inne"). Program jako dataset wejściowy przyjmuje folder "dataset" (znajdujący się w tym samym folderze co [main.py](https://github.com/Bfili/WdSI_Projekt/blob/master/main.py)), w którym znajdują się dwa  kolejne foldery: "images" i "annotations". Podział taki został przyjęty na podstawie datasetu pobranego ze strony [Kaggle](https://www.kaggle.com/andrewmvd/road-sign-detection). 
### Działanie
Działanie programu można opisać poprzez śledzenie poszczególnych linii kodu funkcji main(). Poszczególne funkcje i ich cel zostały opisane w poniższej liście:

 1. load_data(path) - funkcja odpowiada za wczytanie odpowiedniego datasetu, poprzez podanie ścieżki do niego. W przypadku, gdy folder z datasetem znajduje się w tym samym folderze co [main.py](https://github.com/Bfili/WdSI_Projekt/blob/master/main.py) wystarczy jako argument wpisać './', co odnosi się do operacji na plikach w katalogu obecnie wykorzystywanym przez program. Funkcja *load_data* korzysta z biblioteki xml (a dokładniej z funkcji ElementTree) do sprawnego poruszania się w folderze "annotations" po plikach xml, zawierających etykiety i inne informacje o zdjęciach z datasetu. Dzięki odpowiedniemu wykorzystaniu wyżej wymienionej biblioteki pobierane są także dane każdego zdjęcia, wymagane do wyświetlania informacji określonych w zadaniu (nazwa pliku, liczba znaków (obiektów poddawanych klasyfikacji) na nim, koordynaty każdego ze znaków). W celu uzyskania jak najlepszej jakości klasyfikacji i spełnienia warunków określonych w zadaniu, w funkcji *load_data*, zdjęcia były także poddawane odpowiedniej obróbce (z każdego zdjęcia, na podstawie danych z odpowiedniego pliku xml pobierano współrzędne, w których znajduje się obiekt, a następnie go wycinano), a także były przepuszczane przez warunek zajmowania przynajmniej 10% wysokości/szerokości zdjęcia.
 2. train_test_split(data, info_data, test_size=0.3) - funkcja z biblioteki sklearn, z modułu model_selection, służąca do podziału datasetu na dane treningowe i testowe (w proporcjach 70%-30%).
 3. print_test_data(data) - funkcja służąca do wyświetlania informacji na temat każdego ze zdjęć znajdującego się w zbiorze testowym
 4. learn_bovw(data) - funkcja służąca do określenia odpowiednich parametrów (deskryptorów) do klasyfikacji przy pomocy detektora SIFT (w naszym wypadku będą to charakterystyczne punkty na zdjęciach), a następnie dodania ich do słownika wizualnego i zapisaniu w pliku "voc.npy" 
 5. extract_features(data) - funkcja wyciągająca deskryptory z każdego zdjęcia, z datasetu podanego jako argument, przy pomocy słownika stworzonego przez funkcję z punktu 4.
 6. train(data) - funkcja trenująca model wykorzystywany do klasyfikacji przy pomocy RandomForestClassfier z biblioteki sklearn, z modułu ensemble
 7. predict(rf, data) - przyjmuje jako argumenty wytrenowany model i dataset testowy, przy pomocy klasyfikacji każde zdjęcia z datasetu "data" dostanie etykietę odpowiadającą temu co klasyfikator "rf" wykrył. 
 8. evaluate(data) - funkcja odpowiedzialna za obliczenie sprawności klasyfikacji poprzez obliczenie macierzy pomyłek oraz miarę accuracy, wskazującą na to z jaką poprawnością znaki przejść dla pieszych są klasyfikowane jako znaki przejść dla pieszych, a znaki inne jako inne, opisaną wzorem: 
 $$\frac{True Positives}{True Positives + True Negatives},$$ 
 average precision, mówiącą o tym jaką część zaklasyfikowanych znaków jako znaki dla pieszych stanowią faktycznie znaki dla pieszych, opisana wzorem: 
 $$\frac{True Positives}{True Positives + False Positives},$$
 i recall, mówiąc o tym ile znaków dla pieszych było zaklasyfikowanych prawidłowo, opisane wzorem: $$\frac{True Positives}{True Positives + False Negatives},$$
 13. funkcje display(data), draw_grid(...), display_dataset_stats(data) - funkcje odpowiedzialne za interfejs graficzny i wyświetlanie dodatkowych informacji na temat wyniku klasyfikacji (display i draw_grid) lub datasetu (display_dataset_stats)
 14. balance_dataset(data, ratio) - dodatkowa funkcja wykorzystywana w celu pobrania mniejszej próbki z całego datasetu, nie jest konieczna do poprawnego działania programu) 
